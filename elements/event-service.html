<!--
Element which encapsulates the functionality for the Event resource of the Paylogic Ticketing API.

##### Example

    <event-service
      authToken="{{authToken}}"
      baseUrl="{{baseUrl}}"
      on-event-loaded="{{handleEventLoaded}}"></event-service>

@element event-service
@blurb Element which encapsulates the functionality for the Event resource of the Paylogic Ticketing API.
@status alpha
-->

<link rel="import" href="../../polymer/polymer.html">
<link rel="import" href="../../core-ajax/core-ajax.html">

<polymer-element name="event-service" attributes="baseUrl authToken">

  <template>

    <core-ajax
      id="ajax"
      method="{{method}}"
      url="{{baseUrl}}events"
      params="{{params}}"
      headers='{"Authorization": "Basic {{authToken}}"}'
      handleAs="json"
      on-core-response="{{handleGet}}"></core-ajax>

  </template>

  <script>

    Polymer('event-service', {

      /**
       * Fired when the event has been loaded from the API.
       *
       * @event event-loaded
       */

      handleGet: function(event) {
        this.fire('event-loaded', event.detail.response);
      },

      get: function(eventUid) {
        this.method = "GET";
        var eventUri = this.baseUrl + 'events/' + eventUid;
        this.params = {
          "uri": eventUri
        };
        this.$.ajax.go();
      }

    });

  </script>

</polymer-element>
