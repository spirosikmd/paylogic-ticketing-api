<!doctype html>
<html>
<head>
  <meta name="viewport" content="width=device-width, minimum-scale=1.0, initial-scale=1.0, user-scalable=yes">
  <title>paylogic-ticketing-api Demo</title>

  <script src="../platform/platform.js"></script>
  <link rel="import" href="paylogic-ticketing-api.html">

</head>
<body unresolved>

  <paylogic-ticketing-api></paylogic-ticketing-api>

  <template id="event-template" repeat="{{events}}">
    <h1>{{title.en}}</h1>
    <h2>{{subtitle.en}}</h2>
    <p>{{description.en}}</p>
    <p>{{long_description.en}}</p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Subtitle</th>
          <th>Price</th>
          <th>Availability</th>
          <th>Min</th>
          <th>Max</th>
        </tr>
      </thead>
      <tbody>
        <template id="products-template" repeat="{{products}}">
          <tr>
            <td>{{name.en}}</td>
            <td>{{subtitle.en}}</td>
            <td>{{price.currency}} {{price.amount}}</td>
            <td>{{availability}}</td>
            <td>{{min_quantity}}</td>
            <td>{{max_quantity}}</td>
          </tr>
        </template>
      </tbody>
    </table>
  </template>

  <div>
    <h1>List of merchants</h1>
    <ul>
      <template id="merchants-template" repeat="{{merchants}}">
        <li>{{name.en}}</li>
      </template>
    </ul>
  </div>

  <div>
    <h1>List of profiles</h1>
    <ul>
      <template id="profiles-template" repeat="{{profiles}}">
        <li>{{email}}</li>
      </template>
    </ul>
  </div>

  <div>
    <h1>Info about created profile</h1>
    <template id="created-profile-template" repeat="{{profiles}}">
      <dl>
        <dt>Email</dt>
          <dd>{{email}}</dd>
        <dt>Country</dt>
          <dd>{{country}}</dd>
        <dt>First Name</dt>
          <dd>{{first_name}}</dd>
        <dt>Last Name</dt>
          <dd>{{last_name}}</dd>
        <dt>Gender</dt>
          <dd>{{gender}}</dd>
        <dt>Date of birth</dt>
          <dd>{{date_of_birth}}</dd>
      </template>
    </ul>
  </div>

  <div>
    <h1>Info about updated profile</h1>
    <template id="updated-profile-template" repeat="{{profiles}}">
      <dl>
        <dt>Email</dt>
          <dd>{{email}}</dd>
        <dt>Country</dt>
          <dd>{{country}}</dd>
        <dt>First Name</dt>
          <dd>{{first_name}}</dd>
        <dt>Last Name</dt>
          <dd>{{last_name}}</dd>
        <dt>Gender</dt>
          <dd>{{gender}}</dd>
        <dt>Date of birth</dt>
          <dd>{{date_of_birth}}</dd>
      </template>
    </ul>
  </div>

  <div>
    <h1>List of locations</h1>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>City</th>
          <th>Country</th>
          <th>Zipcode</th>
        </tr>
      </thead>
      <tbody>
        <template id="locations-template" repeat="{{locations}}">
          <tr>
            <td>{{name.en}}</td>
            <td>{{city.en}}</td>
            <td>{{country}}</td>
            <td>{{zipcode}}</td>
          </tr>
        </template>
      </tbody>
    </table>
  </div>

  <script>
    document.addEventListener('polymer-ready', function() {
      var pta = document.querySelector('paylogic-ticketing-api');

      var eventUri = "https://ticketapi.sandbox.paylogic.com/events/fb734881f55740a18bed05a06b43ad9c";

      // Initialization of privates is completed.
      pta.addEventListener('init-ready', function() {
        // Use the event uri to get a specific event.
        pta.events.get(eventUri);

        // Use the event uri to get products for a specific event.
        pta.products.filter({"event": eventUri});

        // Get a list of merchants.
        pta.merchants.get();

        // Get a list of profiles.
        pta.profiles.get();

        // Create a profile.
        pta.profiles.create({
          "country": "NL",
          "date_of_birth": "1976-06-04",
          "email": "marc@example.com",
          "first_name": "Marc",
          "gender": 1,
          "last_name": "Legend"
        });

        var profileUri = "https://ticketapi.sandbox.paylogic.com/profiles/a2107be0765e480fa7c639775e4f9444";

        // Update a profile.
        pta.profiles.update({
          profileUri: profileUri,
          data: {
            "email": "nick@example.com"
          }
        });

        // Get a list of locations.
        pta.locations.get();
      });

      // Event service has completed loading the event with the requested uid.
      pta.addEventListener('events-loaded', function(e) {
        document.querySelector('#event-template').model = {
          events: e.detail
        };
      });

      // Product service has completed loading the products from the specified event.
      pta.addEventListener('products-loaded', function(e) {
        document.querySelector('#products-template').model = {
          products: e.detail
        };
      });

      // Merchant service has completed loading the merchants.
      pta.addEventListener('merchants-loaded', function(e) {
        document.querySelector('#merchants-template').model = {
          merchants: e.detail
        };
      });

      // Profile service has completed creating a profile.
      pta.addEventListener('profiles-created', function(e) {
        document.querySelector('#created-profile-template').model = {
          profiles: e.detail
        };
      });

      // Profile service has completed updating a profile.
      pta.addEventListener('profiles-updated', function(e) {
        document.querySelector('#updated-profile-template').model = {
          profiles: e.detail
        };
      });

      // Profile service has completed loading the profiles.
      pta.addEventListener('profiles-loaded', function(e) {
        document.querySelector('#profiles-template').model = {
          profiles: e.detail
        };
      });

      // Location service has completed loading the locations.
      pta.addEventListener('locations-loaded', function(e) {
        document.querySelector('#locations-template').model = {
          locations: e.detail
        };
      });
    });
  </script>

</body>
</html>
