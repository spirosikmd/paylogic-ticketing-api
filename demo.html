<!doctype html>
<html>
<head>
  <meta name="viewport" content="width=device-width, minimum-scale=1.0, initial-scale=1.0, user-scalable=yes">
  <title>paylogic-ticketing-api Demo</title>

  <script src="../platform/platform.js"></script>
  <link rel="import" href="paylogic-ticketing-api.html">

</head>
<body unresolved>

  <paylogic-ticketing-api></paylogic-ticketing-api>

  <h1>List of Events</h1>
  <template id="events-template" repeat="{{events}}">
    <h2>{{title.en}}</h2>
    <h3>{{subtitle.en}}</h3>
    <p>{{description.en}}</p>
    <p>{{long_description.en}}</p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Subtitle</th>
          <th>Price</th>
          <th>Availability</th>
          <th>Min</th>
          <th>Max</th>
        </tr>
      </thead>
      <tbody>
        <template id="products-template" repeat="{{products}}">
          <tr>
            <td>{{name.en}}</td>
            <td>{{subtitle.en}}</td>
            <td>{{price.currency}} {{price.amount}}</td>
            <td>{{availability}}</td>
            <td>{{min_quantity}}</td>
            <td>{{max_quantity}}</td>
          </tr>
        </template>
      </tbody>
    </table>
  </template>

  <div>
    <h1>List of merchants</h1>
    <ul>
      <template id="merchants-template" repeat="{{merchants}}">
        <li>{{name.en}}</li>
      </template>
    </ul>
  </div>

  <div>
    <h1>List of profiles</h1>
    <ul>
      <template id="profiles-template" repeat="{{profiles}}">
        <li>{{email}}</li>
      </template>
    </ul>
  </div>

  <script>
    document.addEventListener('polymer-ready', function() {
      var pta = document.querySelector('paylogic-ticketing-api');

      var eventUri = "https://ticketapi.sandbox.paylogic.com/events/61864469fc2c4abab0039fab9907ad1c";

      // Initialization of privates is completed.
      pta.addEventListener('init-ready', function() {
        // Use the event uri to get a specific event.
        pta.events.get(eventUri);

        // Use the event uri to get products for a specific event.
        pta.products.filter({"event": eventUri});

        // Get a list of merchants.
        pta.merchants.get();

        // Get a list of profiles.
        pta.profiles.get();
      });

      // Event service has completed loading the event with the requested uid.
      pta.addEventListener('pta-events-loaded', function(e) {
        document.querySelector('#events-template').model = {
          events: e.detail
        };
      });

      // Product service has completed loading the products from the specified event.
      pta.addEventListener('pta-products-loaded', function(e) {
        document.querySelector('#products-template').model = {
          products: e.detail
        };
      });

      // Merchant service has completed loading the merchants.
      pta.addEventListener('pta-merchants-loaded', function(e) {
        document.querySelector('#merchants-template').model = {
          merchants: e.detail
        };
      });

      // Profile service has completed loading the profiles.
      pta.addEventListener('pta-profiles-loaded', function(e) {
        document.querySelector('#profiles-template').model = {
          profiles: e.detail
        };
      });
    });
  </script>

</body>
</html>
